# {{ ansible_managed }}

### Sets up environment variables for the custom setup

## The setup directory

# setup directory in current context
export SETUP_DIR="$(dirname "${BASH_SOURCE[0]}")"

# setup directory location for chroot
export SETUP_DIR_CHROOT="/setup"


## The target disk

# the disk
export SETUP_DISK="{{ kubuntu_image_ocs_install_device }}"

# the disk path
export SETUP_DISK_PATH="/dev/$SETUP_DISK"

# the partition number
export SETUP_PART="$(lsblk -nro PARTN "$SETUP_DISK_PATH" | sort -n | tail -1)"

# the partition path
export SETUP_PART_PATH="$SETUP_DISK_PATH$SETUP_PART"


## Hostname and network

# the hostname
export SETUP_HOSTNAME="{{ kubuntu_image_ocs_hostname }}"

# the main network interface
export SETUP_NETWORK_IFACE="{{ kubuntu_image_ocs_network_iface }}"

## Logging

# the logfile used in chroot
export SETUP_CHROOT_LOGFILE="/var/log/setup.log"


## Ansible

# the location of ansible site archive
export SETUP_ANSIBLE_SITE="$SETUP_DIR/ansible-site.tar.gz"

# the name of the ansible playbook to use
export SETUP_ANSIBLE_PLAYBOOK="{{ kubuntu_image_ansible_playbook }}"

{%if kubuntu_image_ansible_inventory_file %}
# the name of the ansible inventory to use
export SETUP_ANSIBLE_INVENTORY={{ kubuntu_image_ansible_inventory_file | quote }}
{% endif %}
